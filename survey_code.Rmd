---
title: "Phd Survey Report"
author: "Haicheng Guo"
date: "2024-01-21"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```







```{r import data }
setwd("D:/RA/Phd_survey")
## manually delete the second and third rows (about notes) before importing data 
## manually delete NA survey (Respondent opened the survey but did not complete it) before importing data ## Manually wrap the line of all the text data to make the export more aesthetically pleasing
data <- read.csv("test_data.csv")



```



This is an analysis for the survey among the M.Phil./Ph.D. students of the Department of Economics to better understand their experiences, concerns, and any suggestions they might have regarding the Ph.D. program. This analysis is an important initiative to help us enhance the overall quality of the program and address any areas of concern.
The survey is divided into 6 sections, which are 1. Academic Experience
; 2. Supervision; 3. Resources; 4. Mental Well-being and Support; 5. Professional Development and Job Market; 6. Feedback and Suggestions. We designed questions in these six aspects and collected data from students and analyse them.



## Part 1. Academic Experience

The first part of the analysis was the academic experience, where we first used formatted questions to collect and analyse students' level of satisfaction with their academic experience in the Department of Economics, followed by an analysis of their main concerns about their academic performance, and finally their personalised opinions.


```{r Question1, General information, echo=FALSE  }
## The options for these questions measure the degree of respondent agreement or disagreement, and to show the degree to which respondents agreed with each aspect of the academic experience, I calculated the mean of the answer scores for each aspect and used bar charts to show the differences in the mean scores for the different aspects of the scores.

## In this question, the higher the score for each indicator, the higher the average level of satisfaction across all respondents.

library(ggplot2)

## fill missing value（"Not applicable" answer）as 0 (if needed). This makes the mean calculation independent of missing values, and adding zeros does not change the calculated mean value.

#data$Q1_6[is.na(data$Q1_6)] <- 0
#data$Q1_7[is.na(data$Q1_7)] <- 0

##Simplify question options to words for better display in bar charts

# The overall academic quality of the courses offered in the program is good. - Course quality
# My program offers enough courses in my research field. - Course quantity
# I have access to a good range of seminars in my research area. - Access to seminars
# I have frequent opportunities to discuss my research with faculties within my institution (in addition to my supervisor). - Access to other faculties
# I find the interactions with other faculty members useful. - Productive discussions with faculties
# I have frequent opportunities to discuss my research with other research students. - Access to other students
# I have frequent opportunities to discuss my research with researchers outside my institution (e.g., seminar speakers). -  Access to other researchers


# selected question columns for generating mean value
selected_columns_Q1 <- c("Q1_1", "Q1_2", "Q1_3", "Q1_4", "Q1_5", "Q1_6", "Q1_7")

# calculate mean values
mean_values_Q1 <- colMeans(data[selected_columns_Q1])

# bar plot
bar_plot_Q1 <- ggplot() +
  geom_bar(data = data.frame(mean_values_Q1), aes(x =c("Course quality", "Course quantity", "Access to seminars", "Access to other faculties", "Productive discussions with faculties", "Access to other students", " Access to other researchers"), y = mean_values_Q1),
           stat = "identity", fill = "steelblue") +
  labs(x = "Academic Experience", y = "Degree of Satisfaction") +
  ggtitle("Figure 1. Academic Experience (Mean Value)")  + theme(axis.text.x = element_text(size = 7, angle = 45, hjust = 1)) + theme(plot.title = element_text(hjust = 0.5))



print(bar_plot_Q1)




```



This graphic shows the average level of student satisfaction with seven aspects regarding the academic experience,the higher the score for each indicator, the higher the average level of satisfaction across all respondents.When the mean value is above 3, it means that the overall attitude of the students is satisfactory,if below 3, it means unsatisfactory.
According to the mean satisfaction scores, the "Productive discussions with faculties" indicator received the highest score of 4.1, indicating that students are highly satisfied with the discussions they have with faculty members. This suggests that students have had positive and effective experiences in their communication with the faculty.
On the other hand, the "Course quantity" indicator received the lowest score of 2.9, indicating that students are not very satisfied with the number of courses available. This may suggest that students desire more course options to meet their academic interests and needs.
Overall, students were satisfied with their academic experience in most aspects, with only one aspect obviously lower than expected.While students are able to gain constructive input from their dialogue with faculties, they struggled to gain the breadth and depth of knowledge from the courses offered by the department.




```{r Question1, Specific answers, echo=FALSE  }

question_columns_Q1 <- c("Q1_1", "Q1_2", "Q1_3", "Q1_4", "Q1_5", "Q1_6", "Q1_7")

frequency_Q1 <- lapply(question_columns_Q1, function(column) {
  table(data[[column]])
})

color_mapping <- c("Definitely disagree" = "red", "Mostly disagree" = "green", "Neither agree nor disagree" = "blue", "Mostly agree" = "yellow", "Definitely agree" = "purple")

# 绘制柱形图
par(mfrow = c(2, 4))  
main_title_Q1 <- "Figure 2. Academic Experience (Individual Value)"

for (i in 1:length(question_columns_Q1)) {
  values <- names(frequency_Q1[[i]])
  values <- factor(values, levels = 1:5)
  
  # 根据颜色映射字典获取每个类别的颜色
  color <- color_mapping[values]
  
  # 设置柱体颜色
  barplot(frequency_Q1[[i]], 
          main = question_columns_Q1[i], 
          xlab = "Answer",
          ylab = "Frequency", 
          ylim = c(0, max(unlist(frequency_Q1))), 
          col = color,
          names.arg = "",
          )
}
title(main = main_title_Q1, line = -1, outer = TRUE)


plot.new()
legend("center", 
       legend = names(color_mapping), 
       fill = unname(color_mapping), 
       title = "Answer",
cex = 0.5)


```



In order to get a concrete picture of each student's specific attitudes towards each question, we further counted the responses to each question.
For each question, we set five options, which included "Definitely disagree", "Mostly disagree", "Neither agree nor disagree", "Mostly agree", "Definitely agree". For each question, we counted the frequency of occurrence of each option.
It is evident that students' dissatisfaction is mainly centred on the quantityof the courses. When asked how satisfied they were with "My program offers enough courses in my research field", 4 people responded "Definitely disagree". There were also students who expressed extreme dissatisfaction with the quality of the courses and academic discussions with faculties and other students.

```{r Question2_separate data, include=FALSE  }


##In qualtrics, responses to multiple choice questions that include more than one option will be recorded in the same cell, which prevents us from counting each response, so it is necessary to assign different responses to different cells before counting them

library(tidyr)

## Assign each response to a different column for multiple choice questions
data <- separate(data, col = "Q2", into = c("Q2_1", "Q2_2", "Q2_3", "Q2_4", "Q2_5", "Q2_6"), sep = ",")


data[is.na(data)] <- 0
```


```{r Question2_analysis, echo=FALSE  }
# selected question columns
selected_columns_Q2 <- c("Q2_1", "Q2_2", "Q2_3", "Q2_4", "Q2_5", "Q2_6")
selected_data_Q2 <- data[, selected_columns_Q2]

# Convert the frequency of responses for each option into a frequency table
selected_matrix_Q2 <- as.matrix(selected_data_Q2)
selected_vector_Q2 <- as.vector(selected_matrix_Q2)
selected_vector_Q2 <- selected_vector_Q2[selected_vector_Q2 != 0]
frequency_table_Q2 <- table(selected_vector_Q2)

#Create a vector of question options to correspond to the numbers recorded for each answer
x_labels <- c("Lack of resources", "Competition with peers", "Others", "No answer")

#if more choice showed in data, add c = ("Workload, "Relationship with advisors") to xlabels

# bar plot
bar_plot_Q2 <- barplot(frequency_table_Q2, main = " Figure 3. Concerns Affecting Academic Performance", xlab = "Answers", ylab = "Frequency", names.arg = x_labels, cex.names = 0.7, ylim = c(0, 10))


```

This graph reflects students' concerns about factors that may affect their academic performance, and we found that lack of resources was the most common concern, and that competition with peers also contributed to students' concerns.
Some students also chose other reasons, which were reflected in their personalised responses. We also collect students' personalised comments, and We anonymised this information and show it below:

Responder4: We have a small department/cohort, which means it nearly impossible to provide enough courses for every field and student. Also, UST is far away from other HK universities, which makes the cost of time/transportation/energy high if I want to make use of the resourses of courses/seminars in other universities. It seems that there is nearly no perfect solution for the problem of limited field courses.

```{r Question3, echo=FALSE}


# Print text information
for (i in 1:nrow(data)) {
  text <- data[i, "Q3"]
  if (!is.na(text) && text != "") {
    
    
    
    text <- gsub("\n", "\\n", text)
    

    cat(paste("Responder", i, ":", text), "\n\n")
  }
}

```

From this information, we find that students expressed concerns about the courses offered by the department as well as the amount of scholarships.






## Part 2. Supervision

The second part of the analysis was the supervision, where we first use formatted questions to collect and analyse students' level of satisfaction with their academic experience in the Department of Economics, and then collect their personalised opinions.

```{r Question4,General information, echo=FALSE  }
## The options for these questions measure the degree of respondent agreement or disagreement, and to show the degree to which respondents agreed with each aspect of the academic experience, I calculated the mean of the answer scores for each aspect and used bar charts to show the differences in the mean scores for the different aspects of the scores

#library(ggplot2)

## In this question, the higher the score for each indicator, the higher the average level of satisfaction across all respondents.


##Simplify question options to words for better display in bar charts

# Overall, I am satisfied with the supervision from my PhD advisor - Overall satisfaction with supervisor
# My supervisor has the skills and subject knowledge to support my research - Skills and subject knowledge
# I have regular contact with my supervisor, appropriate for my needs - Regular contact
# My supervisor has high accessibility (e.g., availability for meetings, responsiveness to emails) - Accessibility
# My supervisor provides feedback that helps me direct my research activities - Research feedback
# My supervisor helps me to identify my training and development needs as a researcher - Development support
# My supervisor shows enough encouragement and understanding to me -  Empathetic support

# selected question columns for generating mean value
selected_columns_Q4 <- c("Q4_1", "Q4_2", "Q4_3", "Q4_4", "Q4_5", "Q4_6", "Q4_7")

# calculate mean values
mean_values_Q4 <- colMeans(data[selected_columns_Q4])

# bar plot
bar_plot_Q4 <- ggplot() +
  geom_bar(data = data.frame(mean_values_Q4), aes(x =c("Overall satisfaction with supervisor", "Skills and subject knowledge", "Regular contact", "Accessibility", "Research feedback", "Development support","Empathetic support"), y = mean_values_Q4),
           stat = "identity", fill = "steelblue") +
  labs(x = "Supervision", y = "Degree of Satisfaction") +
  ggtitle("Figure 4. Satisfaction with Supervisor(Mean Value)")  + theme(axis.text.x = element_text(size = 7, angle = 45, hjust = 1)) + theme(plot.title = element_text(hjust = 0.5))



print(bar_plot_Q4)


```

This graphic shows the average level of student satisfaction with seven aspects regarding the supervision,the higher the score for each indicator, the higher the average level of satisfaction across all respondents.When the mean value is above 3, it means that the overall attitude of the students is satisfactory,if below 3, it means unsatisfactory.
According to the mean satisfaction scores, the "Accessibility" indicator received the highest score of 4.9, indicating that students are highly satisfied with the opportunities for consulting from faculty members. 
On the other hand, other indicators have slightly lower scores, but the mean values are all over 4, which means that student satisfaction with these indicators is also very high. In comparison, students would like to see further improvements in the developmental support provided by the Department.
Overall, students were satisfied with faculty supervision.





```{r Question4,Specific answers, echo=FALSE  }

# 问题列名
question_columns_Q4 <- c("Q4_1", "Q4_2", "Q4_3", "Q4_4", "Q4_5", "Q4_6", "Q4_7")

frequency_Q4 <- lapply(question_columns_Q4, function(column) {
  table(data[[column]])
})

color_mapping <- c("Definitely disagree" = "red", "Mostly disagree" = "green", "Neither agree nor disagree" = "blue", "Mostly agree" = "yellow", "Definitely agree" = "purple")

# 绘制柱形图
par(mfrow = c(2, 4))  

main_title_Q4 <- "Figure 5. Satisfaction with Supervisor (Individual Value)"



for (i in 1:length(question_columns_Q4)) {
  values <- names(frequency_Q4[[i]])
  values <- factor(values, levels = 1:5)
  
  # 根据颜色映射字典获取每个类别的颜色
  color <- color_mapping[values]
  
  # 设置柱体颜色
  barplot(frequency_Q4[[i]], 
          main = question_columns_Q4[i], 
          xlab = "Answer",
          ylab = "Frequency", 
          ylim = c(0, max(unlist(frequency_Q4))), 
          col = color,
          names.arg = values)  
}

title(main = main_title_Q4, line = -1, outer = TRUE)

plot.new()
legend("center", 
       legend = names(color_mapping), 
       fill = unname(color_mapping), 
       title = "Answer",
cex = 0.5)



```


we further counted the responses to each question about supervision.
For each question, we set five options, which included "Definitely disagree", "Mostly disagree", "Neither agree nor disagree", "Mostly agree", "Definitely agree". For each question, we counted the frequency of occurrence of each option.
It is evident that students have little to no dissatisfaction with every aspect of the supervision. More students expressed "Definitely agree" for "supervisor has high accessibility". Some students expressed slightly lower levels of satisfaction with the skills and subject knowledge guidance from supervisors, but overall, students were mostly satisfied with each of these areas.





## Part 3. Resources

The third part of the analysis was the resources, where we first use formatted questions to collect and analyse students' level of satisfaction with their academic experience in the Department of Economics, and then collect their personalised opinions.


```{r Question6,General information, echo=FALSE  }
## The options for these questions measure the degree of respondent agreement or disagreement, and to show the degree to which respondents agreed with each aspect of the academic experience, I calculated the mean of the answer scores for each aspect and used bar charts to show the differences in the mean scores for the different aspects of the scores

#library(ggplot2)

## In this question, the higher the score for each indicator, the higher the average level of satisfaction across all respondents.


##Simplify question options to words for better display in bar charts

# I have a suitable working space when I am on campus - Working space
# There is appropriate access to datasets needed to support my research - Access to datasets
# There is appropriate access to software needed to support my research - Access to software
# There is appropriate access to online journals and books needed to support my research - Access to online journals and books




# selected question columns for generating mean value
selected_columns_Q6 <- c("Q6_1", "Q6_2", "Q6_3", "Q6_4")

# calculate mean values
mean_values_Q6 <- colMeans(data[selected_columns_Q6])

# bar plot
bar_plot_Q6 <- ggplot() +
  geom_bar(data = data.frame(mean_values_Q6), aes(x =c("Working space", "Access to datasets", "Access to software", "Access to online journals and books"), y = mean_values_Q6),
           stat = "identity", fill = "steelblue") +
  labs(x = "Resources", y = "Degree of Satisfaction") +
  ggtitle("Figure 6. Satisfaction with Resources (Mean Value)")  + theme(axis.text.x = element_text(size = 6, angle = 30, hjust = 1))+ theme(plot.title = element_text(hjust = 0.5))



print(bar_plot_Q6)


```




This graphic shows the average level of student satisfaction with four aspects regarding the resources,the higher the score for each indicator, the higher the average level of satisfaction across all respondents.When the mean value is above 3, it means that the overall attitude of the students is satisfactory,if below 3, it means unsatisfactory.
According to the mean satisfaction scores, the "Access to online journals and books" indicator received the highest score of 4.9, indicating that students can download a wide range of academic resources through their school account.
On the other hand, the "Access to software" indicator received the lowest score of 3, indicating that students are not very satisfied with the software available. This may suggest that students desire more softwares to meet their academic interests and needs.








```{r Question6,Specific answers, echo=FALSE  }

# 问题列名
question_columns_Q6 <- c("Q6_1", "Q6_2", "Q6_3", "Q6_4")

frequency_Q6 <- lapply(question_columns_Q6, function(column) {
  table(data[[column]])
})

color_mapping <- c("Definitely disagree" = "red", "Mostly disagree" = "green", "Neither agree nor disagree" = "blue", "Mostly agree" = "yellow", "Definitely agree" = "purple")

# 绘制柱形图
par(mfrow = c(2, 4))  

main_title_Q6 <- "Figure 7. Satisfaction with Resources (Individual Value)"


for (i in 1:length(question_columns_Q6)) {
  values <- names(frequency_Q6[[i]])
  values <- factor(values, levels = 1:5)
  
  # 根据颜色映射字典获取每个类别的颜色
  color <- color_mapping[values]
  
  # 设置柱体颜色
  barplot(frequency_Q6[[i]], 
          main = question_columns_Q6[i], 
          xlab = "Answer",
          ylab = "Frequency", 
          ylim = c(0, max(unlist(frequency_Q6))), 
          col = color,
          names.arg = values)  
}

title(main = main_title_Q6, line = -1, outer = TRUE)

plot.new()
legend("center", 
       legend = names(color_mapping), 
       fill = unname(color_mapping), 
       title = "Answer",
cex = 0.5)


```
we further counted the responses to each question about supervision.
For each question, we set five options, which included "Definitely disagree", "Mostly disagree", "Neither agree nor disagree", "Mostly agree", "Definitely agree". For each question, we counted the frequency of occurrence of each option.
It is evident that students have little to no dissatisfaction with most aspect of the resources. More students expressed "Definitely agree" for "I have a suitable working space when I am on campus" and "There is appropriate access to online journals and books needed to support my research" . Some students expressed lower levels of satisfaction with the access to software. In addition, there was dissatisfaction expressed by students regarding access to datasets.



We also collect students' personalised comments, and We anonymised this information and show it below:


```{r Question7, echo=FALSE  }

# Print text information
for (i in 1:nrow(data)) {
  text_Q7 <- data[i, "Q7"]
  if (!is.na(text_Q7) && text_Q7 != "") {
    
    text_Q7 <- gsub("^\\[\\d+\\]\\s*", "", text_Q7)
    

    cat(paste("Responder", i, ":", text_Q7), "\n\n")
  }
}

```


## Part 4. Mental Well-being and Support

```{r Question8,General information, echo=FALSE  }
## The options for these questions measure the degree of respondent agreement or disagreement, and to show the degree to which respondents agreed with each aspect of the academic experience, I calculated the mean of the answer scores for each aspect and used bar charts to show the differences in the mean scores for the different aspects of the scores

#library(ggplot2)

## In this question, the higher the score for each indicator, the higher the average level of satisfaction across all respondents.


##Simplify question options to words for better display in bar charts

# Your overall mental health over the past year is good - Overall mental health
# There is appropriate access to mental health support when needed - Access to mental health support
# I feel a sense of belonging at my institution - Sense of belonging
# There are sufficient opportunities to interact with other postgraduate research students - Ample student interaction
# Overall, my work and life are balanced - Work-life balance
# I am satisfied with my current financial situation - Financial situation

# selected question columns for generating mean value
selected_columns_Q8 <- c("Q8_1", "Q8_2", "Q8_3", "Q8_4", "Q8_5", "Q8_6")




# calculate mean values
mean_values_Q8 <- colMeans(data[selected_columns_Q8])

# bar plot
bar_plot_Q8 <- ggplot() +
  geom_bar(data = data.frame(mean_values_Q8), aes(x =c("Overall mental health", "Access to mental health support", "Sense of belonging", "Ample student interaction", "Work-life balance", "Financial situation"), y = mean_values_Q8),
           stat = "identity", fill = "steelblue") +
  labs(x = "Mental Well-being and Support", y = "Degree of Satisfaction") +
  ggtitle("Figure 8. Satisfaction with Mental Well-being and Support (Mean Value)")  + theme(axis.text.x = element_text(size = 7, angle = 45, hjust = 1))+ theme(plot.title = element_text(hjust = 0.5))



print(bar_plot_Q8)


```


This graphic shows the average level of student satisfaction with four aspects regarding the resources,the higher the score for each indicator, the higher the average level of satisfaction across all respondents.When the mean value is above 3, it means that the overall attitude of the students is satisfactory,if below 3, it means unsatisfactory.
According to the mean satisfaction scores, the "Access to online journals and books" indicator received the highest score of 4.9, indicating that students can download a wide range of academic resources through their school account.
On the other hand, the "Access to software" indicator received the lowest score of 3, indicating that students are not very satisfied with the software available. This may suggest that students desire more softwares to meet their academic interests and needs.

```{r Question8,Specific answers, echo=FALSE  }

# 问题列名
question_columns_Q8 <- c("Q8_1", "Q8_2", "Q8_3", "Q8_4", "Q8_5", "Q8_6")

frequency_Q8 <- lapply(question_columns_Q8, function(column) {
  table(data[[column]])
})

color_mapping <- c("Definitely disagree" = "red", "Mostly disagree" = "green", "Neither agree nor disagree" = "blue", "Mostly agree" = "yellow", "Definitely agree" = "purple")

# 绘制柱形图
par(mfrow = c(2, 4))  

main_title_Q8 <- "Figure 9. Mental Well-being and Support (Individual Value)"



for (i in 1:length(question_columns_Q8)) {
  values <- names(frequency_Q8[[i]])
  values <- factor(values, levels = 1:5)
  
  # 根据颜色映射字典获取每个类别的颜色
  color <- color_mapping[values]
  
  # 设置柱体颜色
  barplot(frequency_Q8[[i]], 
          main = question_columns_Q8[i], 
          xlab = "Answer",
          ylab = "Frequency", 
          ylim = c(0, max(unlist(frequency_Q8))), 
          col = color,
          names.arg = values)  
}

title(main = main_title_Q8, line = -1, outer = TRUE)

plot.new()
legend("center", 
       legend = names(color_mapping), 
       fill = unname(color_mapping), 
       title = "Answer",
cex = 0.5)


```





we further counted the responses to each question about supervision.
For each question, we set five options, which included "Definitely disagree", "Mostly disagree", "Neither agree nor disagree", "Mostly agree", "Definitely agree". For each question, we counted the frequency of occurrence of each option.
A few students expressed extreme dissatisfaction with their current state of mind, which was mainly reflected in a lack of belonging to the department and a lack of interaction with fellow students. However, at the same time, the majority of students expressed satisfaction with access to mental health support when needed. In addition, a few students expressed concerns about work-life balance and their financial situation.







```{r Question9, echo=FALSE  }

# Print text information
for (i in 1:nrow(data)) {
  text_Q9 <- data[i, "Q9"]
  if (!is.na(text_Q9) && text_Q9 != "") {
    
    text_Q9 <- gsub("^\\[\\d+\\]\\s*", "", text_Q9)
    

    cat(paste("Responder", i, ":", text_Q9), "\n\n")
  }
}

```

We also collect students' personalised comments, and We anonymised this information and show it below:


```{r Question10, echo=FALSE  }

# Print text information
for (i in 1:nrow(data)) {
  text_Q10 <- data[i, "Q10"]
  if (!is.na(text_Q10) && text_Q10 != "") {
    
    text_Q10 <- gsub("^\\[\\d+\\]\\s*", "", text_Q10)
    

    cat(paste("Responder", i, ":", text_Q10), "\n\n")
  }
}

```


## Part 5. Professional Development and Job Market


```{r Question11,General information, echo=FALSE  }
## The options for these questions measure the degree of respondent agreement or disagreement, and to show the degree to which respondents agreed with each aspect of the academic experience, I calculated the mean of the answer scores for each aspect and used bar charts to show the differences in the mean scores for the different aspects of the scores

#library(ggplot2)

## In this question, the higher the score for each indicator, the higher the average level of satisfaction across all respondents.


##Simplify question options to words for better display in bar charts

# My program provides useful career instructions and consultation - Career instructions and consultation
# There are many career development opportunities provided by department/university (e.g., workshops, networking events, job fairs) - Career development opportunities
# As a result of my research degree programme I feel well prepared for my future career - Career preparedness
# My ability to manage projects has developed during my programme - 
# My ability to communicate information effectively to diverse audiences has developed during my programme - Communication skills
# I have developed contacts or professional networks during my programme - Contacts or professional networks


# selected question columns for generating mean value
selected_columns_Q11 <- c("Q11_1", "Q11_2", "Q11_3", "Q11_4", "Q11_5", "Q11_6")

# calculate mean values
mean_values_Q11 <- colMeans(data[selected_columns_Q11])

# bar plot
bar_plot_Q11 <- ggplot() +
  geom_bar(data = data.frame(mean_values_Q11), aes(x =c("Career instructions and consultation", "Career development opportunities", "Career preparedness", "Enhanced project skills", "Communication skills", "Contacts or professional networks"), y = mean_values_Q11),
           stat = "identity", fill = "steelblue") +
  labs(x = "Professional Development and Job Market (Mean Value)", y = "Degree of Satisfaction") +
  ggtitle("Figure 10.Professional Development and Job Market (Mean Value)")  + theme(axis.text.x = element_text(size = 6, angle = 30, hjust = 1))+ theme(plot.title = element_text(hjust = 0.5))



print(bar_plot_Q11)
```

This graphic shows the average level of student satisfaction with six aspects regarding the Professional Development and Job Market,the higher the score for each indicator, the higher the average level of satisfaction across all respondents.When the mean value is above 3, it means that the overall attitude of the students is satisfactory,if below 3, it means unsatisfactory.
According to the mean satisfaction scores, the "Enhanced project skills" and "Communication skills" indicator received the highest score of about 3.8, indicating that Students are better trained in project management and social skills.
On the other hand, the "Career preparedness" indicator received the lowest score of 2.6, indicating that students are not very satisfied with the career service the department provided. 



```{r Question11,Specific answers, echo=FALSE  }

# 问题列名
question_columns_Q11 <- c("Q11_1", "Q11_2", "Q11_3", "Q11_4", "Q11_5", "Q11_6")

frequency_Q11 <- lapply(question_columns_Q11, function(column) {
  table(data[[column]])
})

color_mapping <- c("Definitely disagree" = "red", "Mostly disagree" = "green", "Neither agree nor disagree" = "blue", "Mostly agree" = "yellow", "Definitely agree" = "purple")

# 绘制柱形图
par(mfrow = c(2, 4))  


main_title_Q11 <- "Figure 11. Professional Development and Job Market (Individual Value)"


for (i in 1:length(question_columns_Q11)) {
  values <- names(frequency_Q11[[i]])
  values <- factor(values, levels = 1:5)
  
  # 根据颜色映射字典获取每个类别的颜色
  color <- color_mapping[values]
  
  # 设置柱体颜色
  barplot(frequency_Q11[[i]], 
          main = question_columns_Q11[i], 
          xlab = "Answer",
          ylab = "Frequency", 
          ylim = c(0, max(unlist(frequency_Q11))), 
          col = color,
          names.arg = values)  
}
title(main = main_title_Q11, line = -1, outer = TRUE)


plot.new()
legend("center", 
       legend = names(color_mapping), 
       fill = unname(color_mapping), 
       title = "Answer",
cex = 0.5)


```


we further counted the responses to each question about supervision.
For each question, we set five options, which included "Definitely disagree", "Mostly disagree", "Neither agree nor disagree", "Mostly agree", "Definitely agree". For each question, we counted the frequency of occurrence of each option.
A few students expressed extreme dissatisfaction with aspects about career development. There were also some who felt that the academic network they had developed in the department was lower than expected. Comparatively, most students were satisfied with their project management skills.


```{r Question12, echo=FALSE , warning=FALSE }
#Q12
##Separating multiple-choice questions

#library(tidyr)

data <- separate(data, col = "Q12", into = c("Q12_1", "Q12_2", "Q12_3", "Q12_4", "Q12_5", "Q12_6"), sep = ",")


data[is.na(data)] <- 0





```


```{r Question12_analysis, echo=FALSE  }
# selected question columns
selected_columns_Q12 <- c("Q12_1", "Q12_2", "Q12_3", "Q12_4", "Q12_5", "Q12_6")
selected_data_Q12 <- data[, selected_columns_Q12]

# Convert the frequency of responses for each option into a frequency table
selected_matrix_Q12 <- as.matrix(selected_data_Q12)
selected_vector_Q12 <- as.vector(selected_matrix_Q12)
selected_vector_Q12 <- selected_vector_Q12[selected_vector_Q12 != 0]
frequency_table_Q12 <- table(selected_vector_Q12)



#Create a vector of question options to correspond to the numbers recorded for each answer
x_labels <- c("Lack of opportunities", "Not clear","Job security", "Work-life balance", "Salary expectations" )

##if needed, add "Others" to x_labels

# bar plot
bar_plot_Q12 <- barplot(frequency_table_Q12, main = "Figure 12. Main Concerns about the Job Market", xlab = "Answers", ylab = "Frequency", names.arg = x_labels, cex.names = 0.6)

```

This graph reflects students' concerns about job market, and we found that work-life balance was the most common concern, and that lack of opportunities and salary also contributed to students' concerns.
We also collect students' personalised comments, and We anonymised this information and show it below:




```{r Question13, echo=FALSE, warning=FALSE  }
#Q13
##Separating multiple-choice questions

#library(tidyr)

data <- separate(data, col = "Q13", into = c("Q13_1", "Q13_2", "Q13_3", "Q13_4", "Q13_5", "Q13_6","Q13_7","Q13_8"), sep = ",")


data[is.na(data)] <- 0





```


```{r Question13_analysis, echo=FALSE  }
# selected question columns
selected_columns_Q13 <- c("Q13_1", "Q13_2", "Q13_3", "Q13_4", "Q13_5", "Q13_6", "Q13_7", "Q13_8")
selected_data_Q13 <- data[, selected_columns_Q13]

# Convert the frequency of responses for each option into a frequency table
selected_matrix_Q13 <- as.matrix(selected_data_Q13)
selected_vector_Q13 <- as.vector(selected_matrix_Q13)
selected_vector_Q13 <- selected_vector_Q13[selected_vector_Q13 != 0]
frequency_table_Q13 <- table(selected_vector_Q13)

#Create a vector of question options to correspond to the numbers recorded for each answer
x_labels <- c("Academic career in higher education", "Research career in higher education", "Research career outside higher education","Teaching below higher education","Any other professional career", "Self-employment " )

##if needed, add "Others" to x_labels


color_mapping_Q13 <- c("Academic career in higher education" = "red", "Research career in higher education" = "green", "Research career outside higher education" = "blue", "Teaching below higher education" = "yellow", "Any other professional career" = "purple", "Self-employment" = "pink")

color_Q13 <- c("red", "green","blue","yellow","purple","pink")

# bar plot
bar_plot_Q13 <- barplot(frequency_table_Q13, main = "Figure 13. Future Plan", xlab = "Answers", ylab = "Frequency",ylim = c(0, 12), names.arg = "", cex.names = 0.5,col = color_Q13)
legend("topright", 
       legend = names(color_mapping_Q13), 
       fill = unname(color_mapping_Q13), 
cex = 0.6)

```

This graph reflects students' concerns about their future plan.
Most students plan to continue pursuing their careers in academia after graduation, while others plan to seek research jobs in industry, and a few plan to continue their careers in other fields, such as teaching track or self-employment.


We also collect students' personalised comments, and We anonymised this information and show it below:


```{r Question14, echo=FALSE  }

# Print text information
for (i in 1:nrow(data)) {
  text_Q14 <- data[i, "Q14"]
  if (!is.na(text_Q14) && text_Q14 != "") {
    
    text_Q14 <- gsub("^\\[\\d+\\]\\s*", "", text_Q14)
    

    cat(paste("Responder", i, ":", text_Q14), "\n\n")
  }
}

```

## Part 6. feedback and suggestions


Finally, we collected feedback and suggestions from students, which we anonymised and presented in full.

Below are suggestions of students for improving the PhD program in the economics department:

```{r Question15, echo=FALSE  }

# Print text information
for (i in 1:nrow(data)) {
  text_Q15 <- data[i, "Q15"]
  if (!is.na(text_Q15) && text_Q15 != "") {
    
    text_Q15 <- gsub("^\\[\\d+\\]\\s*", "", text_Q15)
    

    cat(paste("Responder", i, ":", text_Q15), "\n\n")
  }
}

```
Below are feedback or comments that some students would like to share:


```{r Question16, echo=FALSE  }

# Print text information
for (i in 1:nrow(data)) {
  text_Q16 <- data[i, "Q16"]
  if (!is.na(text_Q16) && text_Q16 != "") {
    
    text_Q16 <- gsub("^\\[\\d+\\]\\s*", "", text_Q16)
    

    cat(paste("Responder", i, ":", text_Q16), "\n\n")
  }
}

```
